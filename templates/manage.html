{% extends "base.html" %} {% block content %}
<div class="row row-offcanvas row-offcanvas-right">
	<div class="col-xs-9 col-sm-9">
		<p class="pull-right visible-xs">
			<button type="button" class="btn btn-primary btn-xs" data-toggle="offcanvas">Toggle nav</button>
		</p>
		<div class="jumbotron">
			<h1>管理员界面</h1>
			<p>It is my blog but is constructing still.</p>
		</div>
		<div class="row" id="contentdiv">
			<div class="col-xs-12 col-lg-12">
				<h2>标题一</h2>
				<p>There is neither happiness nor misery in the world; there is only the comparison of one state with another,nothing more.He who has felt the deepest grief is best able to experience supreme happiness.We must have felt what it is to die,Morrel,that we may appreciate the enjoyments of living. </p>
				<p>
					<a class="btn btn-default" href="#" role="button">查看详情 &raquo;</a>
					<a class="btn btn-default delBtn" href="#" role="button" id="delId">删除 &omega;</a>
				</p>
			</div>
			<!--/.col-xs-6.col-lg-4-->

		</div>
	</div>

	<div class="col-xs-3 col-sm-3 sidebar-offcanvas" id="sidebar" style="margin-top: 100px;">
		<div class="list-group">
			<!--<a href="#" class="list-group-item active">Link</a>-->
			<a href="/addmsg" class="list-group-item">添加文章</a>
			<a href="#" class="list-group-item">Link</a>
			<a href="#" class="list-group-item">Link</a>
			<a href="#" class="list-group-item">Link</a>
			<a href="#" class="list-group-item">Link</a>
			<a href="#" class="list-group-item">Link</a>
			<a href="#" class="list-group-item">Link</a>
			<a href="#" class="list-group-item">Link</a>
			<a href="#" class="list-group-item">Link</a>
		</div>
	</div>
	<!--/.sidebar-offcanvas-->
</div>
<!--/row-->
{% endblock %} {% block script %}
<script type="text/javascript">
	function msgDel(id){
		$.ajax({
			url: "http://localhost:5678/msgDel?id="+ id,
			method:'get',
			success: function(data) {
				console.log(data)
			},
			error: function(msg) {
				console.log("error:删除数据失败")
			}
		});
	}
	function loaddata() {
		$.ajax({
			url: "http://localhost:5678/msgSelect",
			success: function(data) {
				console.log(data)
				jsonData = JSON.parse(data)
				for(var a = 0; a < jsonData.length; a++) {
					id = jsonData[a].id
					title = jsonData[a].title
					shortmsg = jsonData[a].shortmsg
					msg = jsonData[a].msg
					var ele = '<div id="' + id + '"  class="col-xs-12 col-lg-12"> <h2>' + title + '</h2> <p>' + shortmsg + ' </p> <p> <a class="btn btn-default" href="/content?id=' + id +'" role="button">查看详情 &raquo;</a> <a class="btn btn-default delBtn" href="#" role="button" id="delId">删除 &omega;</a></p> </div>'
					$("#contentdiv").append(ele)
					
					
				}
				$(".delBtn").click(function(){
						console.log("-------")
						console.log($(this).parents("div")[0])
						var a = $(this).parents("div").attr("id")
						console.log(a)
						msgDel(a)
						$(this).parents("div")[0].remove()
					})

			},
			error: function(msg) {
				console.log("error:获取数据失败")
			}
		});
	}
	loaddata()
	
</script>
{% endblock %}